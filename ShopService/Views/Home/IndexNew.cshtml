@using ShopService.Models
@model IList<Device>

@{
    Layout = null;
}
<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <title>AJAX Index</title>
    </head>
<body class="back">
    <div id ="content" class="text-center">
    <h1>Электронный магазин компьютерной техники: </h1>
    <h2>Каталог устройств:</h2>
    <table class="table">
        <thead>
            <tr>
                <th>Тип устройства</th>
                <th>Название</th>
                <th>Производитель</th>
                <th>Цена устройства</th>
                @*
                    <th>Размер (дюйм.)</th>
                <th>Разрешение экрана</th>
                <th>Камера (мп)</th>
                <th>Емкость аккумулятора</th>
                <th>Объем оперативной памяти</th>
                *@
            </tr>
        </thead>
        <tbody>
            @foreach(var item in Model)
            {
                <tr>
                    <td>@Html.DisplayFor(x => item.DeviceType!.Name)</td>
                    <td>@Html.DisplayFor(x => item.Name)</td>
                    <td>@Html.DisplayFor(x => item.Producer!.Name)</td>
                    <td>@Html.DisplayFor(x => item.Cost)</td>
                    @*
                        <td>@Html.DisplayFor(x => item.Size)</td>
                    <td>@Html.DisplayFor(x => item.ScreenResolution)</td>
                    <td>@Html.DisplayFor(x => item.CamMp)</td>
                    <td>@Html.DisplayFor(x => item.AccumCapacity)</td>
                    <td>@Html.DisplayFor(x => item.RAM)</td>
                    *@
                    <td class="link">
                        <a href="@Url.Action("Details", "Home", new {Id = item.Id})" class="button">Подробнее</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<div id="partialModal" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Device Details Form</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous" />
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" 
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script type="text/javascript">
$(function() {
    $("#DeviceGrid .details").click(function() {
        var deviceId = $(this).closest("tr").find("td").eq(0).html();
        $.ajax({
            type: "POST",
            url: "/Home/DetailsNew",
            data: { "deviceId": deviceId },
            success: function (response) {
                $("#partialModal").find(".modal-body").html(response);
                $("#partialModal").modal('show');
            },
            failure: function (response) {
                alert(response.responseText);
            },
            error: function (response) {
                alert(response.responseText);
            }
        });
    });
});
</script>
</body>
</html>